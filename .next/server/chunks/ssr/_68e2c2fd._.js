module.exports=[3130,a=>{"use strict";var b=a.i(91293),c=a.i(97895);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card",className:(0,c.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...d})}function e({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-header",className:(0,c.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...d})}function f({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-title",className:(0,c.cn)("leading-none font-semibold",a),...d})}function g({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-description",className:(0,c.cn)("text-muted-foreground text-sm",a),...d})}function h({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-content",className:(0,c.cn)("px-6",a),...d})}a.s(["Card",()=>d,"CardContent",()=>h,"CardDescription",()=>g,"CardHeader",()=>e,"CardTitle",()=>f])},6253,a=>{"use strict";var b=a.i(47289);function c(a){let[c,d]=(0,b.useState)([]),[e,f]=(0,b.useState)([]),[g,h]=(0,b.useState)(null),[i,j]=(0,b.useState)(null),[k,l]=(0,b.useState)([]),[m,n]=(0,b.useState)(null),[o,p]=(0,b.useState)(!1),[q,r]=(0,b.useState)(!0),s=process.env.NEXT_PUBLIC_BACKEND_PORT||"5001",t="";t=process.env.NEXT_PUBLIC_WS_URL||`ws://localhost:${s}`;let u=a?.url||t;return(0,b.useEffect)(()=>{let a,b,c=()=>{try{(a=new WebSocket(u)).onopen=()=>{console.log("âœ… Connected to server"),p(!0),r(!1)},a.onmessage=a=>{let b=JSON.parse(a.data);switch(b.type){case"initial-data":d(b.data.alerts),f(b.data.logs),h(b.data.trafficData),b.data.networkData&&j(b.data.networkData),b.data.networkData&&l(a=>[...a.slice(-29),b.data.networkData]),b.data.health&&n(b.data.health);break;case"new-alert":d(a=>[b.data,...a].slice(0,20));break;case"alert-updated":d(a=>a.map(a=>a.id===b.data.id?b.data:a));break;case"new-log":f(a=>[b.data,...a].slice(0,50));break;case"traffic-update":h(b.data);break;case"network-update":j(b.data),l(a=>[...a.slice(-29),b.data]);break;case"health-update":n(b.data)}},a.onerror=a=>{console.error("âŒ WebSocket error:",a),p(!1)},a.onclose=()=>{console.log("ðŸ”Œ Disconnected from server"),p(!1),b=setTimeout(c,3e3)}}catch(a){console.error("Failed to connect:",a),p(!1),b=setTimeout(c,3e3)}};return c(),()=>{a&&a.close(),b&&clearTimeout(b)}},[u]),(0,b.useEffect)(()=>{let a=`http://localhost:${process.env.NEXT_PUBLIC_BACKEND_PORT||"5001"}`;fetch(`${a}/api/network`).then(a=>a.json()).then(a=>{a&&j(a)}).catch(()=>{}),fetch(`${a}/api/health`).then(a=>a.json()).then(a=>{a&&n(a)}).catch(()=>{})},[]),{alerts:c,logs:e,traffic:g,network:i,networkHistory:k,health:m,connected:o,loading:q,updateAlertStatus:(0,b.useCallback)(async(a,b)=>{try{let c=`http://localhost:${process.env.NEXT_PUBLIC_BACKEND_PORT||"5001"}`;return(await fetch(`${c}/api/alerts/${a}/status`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:b})})).json()}catch(a){throw console.error("Failed to update alert:",a),a}},[])}}a.s(["useRealTime",()=>c])},88237,a=>{"use strict";var b=a.i(91293),c=a.i(97895);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,b.jsx)("table",{"data-slot":"table",className:(0,c.cn)("w-full caption-bottom text-sm",a),...d})})}function e({className:a,...d}){return(0,b.jsx)("thead",{"data-slot":"table-header",className:(0,c.cn)("[&_tr]:border-b",a),...d})}function f({className:a,...d}){return(0,b.jsx)("tbody",{"data-slot":"table-body",className:(0,c.cn)("[&_tr:last-child]:border-0",a),...d})}function g({className:a,...d}){return(0,b.jsx)("tr",{"data-slot":"table-row",className:(0,c.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",a),...d})}function h({className:a,...d}){return(0,b.jsx)("th",{"data-slot":"table-head",className:(0,c.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...d})}function i({className:a,...d}){return(0,b.jsx)("td",{"data-slot":"table-cell",className:(0,c.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...d})}a.s(["Table",()=>d,"TableBody",()=>f,"TableCell",()=>i,"TableHead",()=>h,"TableHeader",()=>e,"TableRow",()=>g])},40550,a=>{"use strict";let b=(0,a.i(61237).default)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);a.s(["default",()=>b])},82979,a=>{"use strict";let b=(0,a.i(61237).default)("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);a.s(["ShieldAlert",()=>b],82979)},73278,a=>{"use strict";var b=a.i(91293);let c=(0,a.i(61237).default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var d=a.i(27491),e=a.i(40550),e=e,f=a.i(97895),g=a.i(40695);function h({className:a,...c}){return(0,b.jsx)("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:(0,f.cn)("mx-auto flex w-full justify-center",a),...c})}function i({className:a,...c}){return(0,b.jsx)("ul",{"data-slot":"pagination-content",className:(0,f.cn)("flex flex-row items-center gap-1",a),...c})}function j({...a}){return(0,b.jsx)("li",{"data-slot":"pagination-item",...a})}function k({className:a,isActive:c,size:d="icon",...e}){return(0,b.jsx)("a",{"aria-current":c?"page":void 0,"data-slot":"pagination-link","data-active":c,className:(0,f.cn)((0,g.buttonVariants)({variant:c?"outline":"ghost",size:d}),a),...e})}function l({className:a,...d}){return(0,b.jsxs)(k,{"aria-label":"Go to previous page",size:"default",className:(0,f.cn)("gap-1 px-2.5 sm:pl-2.5",a),...d,children:[(0,b.jsx)(c,{}),(0,b.jsx)("span",{className:"hidden sm:block",children:"Previous"})]})}function m({className:a,...c}){return(0,b.jsxs)(k,{"aria-label":"Go to next page",size:"default",className:(0,f.cn)("gap-1 px-2.5 sm:pr-2.5",a),...c,children:[(0,b.jsx)("span",{className:"hidden sm:block",children:"Next"}),(0,b.jsx)(d.ChevronRightIcon,{})]})}function n({className:a,...c}){return(0,b.jsxs)("span",{"aria-hidden":!0,"data-slot":"pagination-ellipsis",className:(0,f.cn)("flex size-9 items-center justify-center",a),...c,children:[(0,b.jsx)(e.default,{className:"size-4"}),(0,b.jsx)("span",{className:"sr-only",children:"More pages"})]})}a.s(["Pagination",()=>h,"PaginationContent",()=>i,"PaginationEllipsis",()=>n,"PaginationItem",()=>j,"PaginationLink",()=>k,"PaginationNext",()=>m,"PaginationPrevious",()=>l],73278)},41523,a=>{"use strict";var b=a.i(91293),c=a.i(47289),d=a.i(53581),e=a.i(61237);let f=(0,e.default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),g=(0,e.default)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);var h=a.i(7085),i=a.i(82979),j=a.i(54161),k=a.i(40695),l=a.i(3130),m=a.i(76504),n=a.i(5522),o=a.i(87682),p=a.i(88237),q=a.i(73278),r=a.i(6253);function s(){let{alerts:a,connected:e,loading:s}=(0,r.useRealTime)(),[t,u]=c.useState("all"),v=a.filter(a=>"Critical"===a.severity).length,w=a.filter(a=>"Investigating"===a.status).length,x=a.filter(a=>"Resolved"===a.status).length,y="all"===t?a:a.filter(a=>a.status.toLowerCase()===t.toLowerCase());return(0,b.jsxs)("div",{className:"flex flex-col gap-6 p-6",children:[(0,b.jsx)("div",{className:"flex flex-col gap-2",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Security Alerts"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage and investigate security incidents and anomalies"})]}),(0,b.jsx)("div",{className:`text-sm font-medium ${e?"text-green-600":"text-red-600"}`,children:e?"ðŸŸ¢ Live":"ðŸ”´ Connecting..."})]})}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,b.jsxs)(l.Card,{className:"bg-gradient-to-r from-rose-50 to-rose-100",children:[(0,b.jsxs)(l.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(l.CardTitle,{className:"text-sm font-medium",children:"Critical Alerts"}),(0,b.jsx)(i.ShieldAlert,{className:"size-4 text-destructive"})]}),(0,b.jsxs)(l.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:v}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Requires immediate attention"})]})]}),(0,b.jsxs)(l.Card,{className:"bg-gradient-to-r from-yellow-50 to-yellow-100",children:[(0,b.jsxs)(l.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(l.CardTitle,{className:"text-sm font-medium",children:"Active Investigations"}),(0,b.jsx)(d.AlertTriangle,{className:"size-4 text-accent"})]}),(0,b.jsxs)(l.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:w}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Currently being analyzed"})]})]}),(0,b.jsxs)(l.Card,{className:"bg-gradient-to-r from-emerald-50 to-emerald-100",children:[(0,b.jsxs)(l.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(l.CardTitle,{className:"text-sm font-medium",children:"Resolved Today"}),(0,b.jsx)(f,{className:"size-4 text-green-500"})]}),(0,b.jsxs)(l.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:x}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Successfully mitigated"})]})]})]}),(0,b.jsxs)(l.Card,{children:[(0,b.jsx)(l.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.CardTitle,{children:"Alert History"}),(0,b.jsx)(l.CardDescription,{children:"Real-time security alerts and their current status"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(h.Search,{className:"absolute left-2.5 top-2.5 size-4 text-muted-foreground"}),(0,b.jsx)(n.Input,{type:"search",placeholder:"Search alerts...",className:"w-[200px] pl-8 lg:w-[300px]"})]}),(0,b.jsxs)(m.DropdownMenu,{children:[(0,b.jsx)(m.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(k.Button,{variant:"outline",size:"icon",children:(0,b.jsx)(g,{className:"size-4"})})}),(0,b.jsxs)(m.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(m.DropdownMenuLabel,{children:"Filter by Severity"}),(0,b.jsx)(m.DropdownMenuSeparator,{}),(0,b.jsx)(m.DropdownMenuCheckboxItem,{checked:!0,children:"Critical"}),(0,b.jsx)(m.DropdownMenuCheckboxItem,{checked:!0,children:"High"}),(0,b.jsx)(m.DropdownMenuCheckboxItem,{checked:!0,children:"Medium"}),(0,b.jsx)(m.DropdownMenuCheckboxItem,{checked:!0,children:"Low"})]})]}),(0,b.jsxs)(o.Select,{value:t,onValueChange:u,children:[(0,b.jsx)(o.SelectTrigger,{className:"w-[130px]",children:(0,b.jsx)(o.SelectValue,{placeholder:"Status"})}),(0,b.jsxs)(o.SelectContent,{children:[(0,b.jsx)(o.SelectItem,{value:"all",children:"All Status"}),(0,b.jsx)(o.SelectItem,{value:"active",children:"Active"}),(0,b.jsx)(o.SelectItem,{value:"investigating",children:"Investigating"}),(0,b.jsx)(o.SelectItem,{value:"resolved",children:"Resolved"})]})]})]})]})}),(0,b.jsx)(l.CardContent,{children:s?(0,b.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,b.jsx)("div",{className:"text-muted-foreground",children:"Loading real-time data..."})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(p.Table,{children:[(0,b.jsx)(p.TableHeader,{children:(0,b.jsxs)(p.TableRow,{children:[(0,b.jsx)(p.TableHead,{children:"ID"}),(0,b.jsx)(p.TableHead,{children:"Severity"}),(0,b.jsx)(p.TableHead,{children:"Type"}),(0,b.jsx)(p.TableHead,{children:"Source"}),(0,b.jsx)(p.TableHead,{children:"Destination"}),(0,b.jsx)(p.TableHead,{children:"Status"}),(0,b.jsx)(p.TableHead,{children:"Timestamp"}),(0,b.jsx)(p.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(p.TableBody,{children:y.length>0?y.map(a=>(0,b.jsxs)(p.TableRow,{children:[(0,b.jsx)(p.TableCell,{className:"font-medium",children:a.id}),(0,b.jsx)(p.TableCell,{children:(0,b.jsx)(j.Badge,{variant:"Critical"===a.severity?"destructive":"High"===a.severity?"default":"Medium"===a.severity?"secondary":"outline",className:"High"===a.severity?"bg-orange-500 hover:bg-orange-600":"",children:a.severity})}),(0,b.jsx)(p.TableCell,{children:a.type}),(0,b.jsx)(p.TableCell,{className:"font-mono text-xs",children:a.source}),(0,b.jsx)(p.TableCell,{className:"font-mono text-xs",children:a.destination}),(0,b.jsx)(p.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:["Active"===a.status&&(0,b.jsx)("div",{className:"size-2 rounded-full bg-destructive animate-pulse"}),"Investigating"===a.status&&(0,b.jsx)("div",{className:"size-2 rounded-full bg-accent"}),"Resolved"===a.status&&(0,b.jsx)("div",{className:"size-2 rounded-full bg-green-500"}),a.status]})}),(0,b.jsx)(p.TableCell,{className:"text-muted-foreground text-xs",children:new Date(a.timestamp).toLocaleString()}),(0,b.jsx)(p.TableCell,{className:"text-right",children:(0,b.jsx)(k.Button,{variant:"ghost",size:"sm",children:"Details"})})]},a.id)):(0,b.jsx)(p.TableRow,{children:(0,b.jsx)(p.TableCell,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No alerts found"})})})]}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)(q.Pagination,{children:(0,b.jsxs)(q.PaginationContent,{children:[(0,b.jsx)(q.PaginationItem,{children:(0,b.jsx)(q.PaginationPrevious,{href:"#"})}),(0,b.jsx)(q.PaginationItem,{children:(0,b.jsx)(q.PaginationLink,{href:"#",isActive:!0,children:"1"})}),(0,b.jsx)(q.PaginationItem,{children:(0,b.jsx)(q.PaginationLink,{href:"#",children:"2"})}),(0,b.jsx)(q.PaginationItem,{children:(0,b.jsx)(q.PaginationLink,{href:"#",children:"3"})}),(0,b.jsx)(q.PaginationItem,{children:(0,b.jsx)(q.PaginationEllipsis,{})}),(0,b.jsx)(q.PaginationItem,{children:(0,b.jsx)(q.PaginationNext,{href:"#"})})]})})})]})})]})]})}a.s(["default",()=>s],41523)}];

//# sourceMappingURL=_68e2c2fd._.js.map