(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,50607,e=>{"use strict";var t=e.i(27055),a=e.i(64067);function s(e){let[s,l]=(0,a.useState)([]),[i,n]=(0,a.useState)([]),[r,c]=(0,a.useState)(null),[d,o]=(0,a.useState)(null),[x,h]=(0,a.useState)([]),[u,m]=(0,a.useState)(null),[j,g]=(0,a.useState)(!1),[f,p]=(0,a.useState)(!0),b=t.default.env.NEXT_PUBLIC_BACKEND_PORT||"5001",v=t.default.env.NEXT_PUBLIC_WS_URL||`ws://${window.location.hostname}:${b}`,N=e?.url||v;return(0,a.useEffect)(()=>{let e,t,a=()=>{try{(e=new WebSocket(N)).onopen=()=>{console.log("âœ… Connected to server"),g(!0),p(!1)},e.onmessage=e=>{let t=JSON.parse(e.data);switch(t.type){case"initial-data":l(t.data.alerts),n(t.data.logs),c(t.data.trafficData),t.data.networkData&&o(t.data.networkData),t.data.networkData&&h(e=>[...e.slice(-29),t.data.networkData]),t.data.health&&m(t.data.health);break;case"new-alert":l(e=>[t.data,...e].slice(0,20));break;case"alert-updated":l(e=>e.map(e=>e.id===t.data.id?t.data:e));break;case"new-log":n(e=>[t.data,...e].slice(0,50));break;case"traffic-update":c(t.data);break;case"network-update":o(t.data),h(e=>[...e.slice(-29),t.data]);break;case"health-update":m(t.data)}},e.onerror=e=>{console.error("âŒ WebSocket error:",e),g(!1)},e.onclose=()=>{console.log("ðŸ”Œ Disconnected from server"),g(!1),t=setTimeout(a,3e3)}}catch(e){console.error("Failed to connect:",e),g(!1),t=setTimeout(a,3e3)}};return a(),()=>{e&&e.close(),t&&clearTimeout(t)}},[N]),(0,a.useEffect)(()=>{let e=t.default.env.NEXT_PUBLIC_BACKEND_PORT||"5001",a=window.location.hostname,s=t.default.env.NEXT_PUBLIC_API_URL||`http://${a}:${e}`;fetch(`${s}/api/network`).then(e=>e.json()).then(e=>{e&&o(e)}).catch(()=>{}),fetch(`${s}/api/health`).then(e=>e.json()).then(e=>{e&&m(e)}).catch(()=>{})},[]),{alerts:s,logs:i,traffic:r,network:d,networkHistory:x,health:u,connected:j,loading:f,updateAlertStatus:(0,a.useCallback)(async(e,a)=>{try{let s=t.default.env.NEXT_PUBLIC_BACKEND_PORT||"5001",l=t.default.env.NEXT_PUBLIC_API_URL||`http://${window.location.hostname}:${s}`;return(await fetch(`${l}/api/alerts/${e}/status`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:a})})).json()}catch(e){throw console.error("Failed to update alert:",e),e}},[])}}e.s(["useRealTime",()=>s])},47627,e=>{"use strict";var t=e.i(28785),a=e.i(47163);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,t.jsx)("table",{"data-slot":"table",className:(0,a.cn)("w-full caption-bottom text-sm",e),...s})})}function l({className:e,...s}){return(0,t.jsx)("thead",{"data-slot":"table-header",className:(0,a.cn)("[&_tr]:border-b",e),...s})}function i({className:e,...s}){return(0,t.jsx)("tbody",{"data-slot":"table-body",className:(0,a.cn)("[&_tr:last-child]:border-0",e),...s})}function n({className:e,...s}){return(0,t.jsx)("tr",{"data-slot":"table-row",className:(0,a.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...s})}function r({className:e,...s}){return(0,t.jsx)("th",{"data-slot":"table-head",className:(0,a.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}function c({className:e,...s}){return(0,t.jsx)("td",{"data-slot":"table-cell",className:(0,a.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}e.s(["Table",()=>s,"TableBody",()=>i,"TableCell",()=>c,"TableHead",()=>r,"TableHeader",()=>l,"TableRow",()=>n])},71348,e=>{"use strict";let t=(0,e.i(10965).default)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);e.s(["default",()=>t])},10850,e=>{"use strict";let t=(0,e.i(10965).default)("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);e.s(["ShieldAlert",()=>t],10850)},46371,e=>{"use strict";var t=e.i(28785);let a=(0,e.i(10965).default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var s=e.i(65892),l=e.i(71348),l=l,i=e.i(47163),n=e.i(67881);function r({className:e,...a}){return(0,t.jsx)("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:(0,i.cn)("mx-auto flex w-full justify-center",e),...a})}function c({className:e,...a}){return(0,t.jsx)("ul",{"data-slot":"pagination-content",className:(0,i.cn)("flex flex-row items-center gap-1",e),...a})}function d({...e}){return(0,t.jsx)("li",{"data-slot":"pagination-item",...e})}function o({className:e,isActive:a,size:s="icon",...l}){return(0,t.jsx)("a",{"aria-current":a?"page":void 0,"data-slot":"pagination-link","data-active":a,className:(0,i.cn)((0,n.buttonVariants)({variant:a?"outline":"ghost",size:s}),e),...l})}function x({className:e,...s}){return(0,t.jsxs)(o,{"aria-label":"Go to previous page",size:"default",className:(0,i.cn)("gap-1 px-2.5 sm:pl-2.5",e),...s,children:[(0,t.jsx)(a,{}),(0,t.jsx)("span",{className:"hidden sm:block",children:"Previous"})]})}function h({className:e,...a}){return(0,t.jsxs)(o,{"aria-label":"Go to next page",size:"default",className:(0,i.cn)("gap-1 px-2.5 sm:pr-2.5",e),...a,children:[(0,t.jsx)("span",{className:"hidden sm:block",children:"Next"}),(0,t.jsx)(s.ChevronRightIcon,{})]})}function u({className:e,...a}){return(0,t.jsxs)("span",{"aria-hidden":!0,"data-slot":"pagination-ellipsis",className:(0,i.cn)("flex size-9 items-center justify-center",e),...a,children:[(0,t.jsx)(l.default,{className:"size-4"}),(0,t.jsx)("span",{className:"sr-only",children:"More pages"})]})}e.s(["Pagination",()=>r,"PaginationContent",()=>c,"PaginationEllipsis",()=>u,"PaginationItem",()=>d,"PaginationLink",()=>o,"PaginationNext",()=>h,"PaginationPrevious",()=>x],46371)},16954,e=>{"use strict";var t=e.i(28785),a=e.i(64067),s=e.i(64877),l=e.i(10965);let i=(0,l.default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),n=(0,l.default)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);var r=e.i(5576),c=e.i(10850),d=e.i(94179),o=e.i(67881),x=e.i(70065),h=e.i(63415),u=e.i(23750),m=e.i(62870),j=e.i(47627),g=e.i(46371),f=e.i(50607);function p(){let{alerts:e,connected:l,loading:p}=(0,f.useRealTime)(),[b,v]=a.useState("all"),N=e.filter(e=>"Critical"===e.severity).length,C=e.filter(e=>"Investigating"===e.status).length,y=e.filter(e=>"Resolved"===e.status).length,w="all"===b?e:e.filter(e=>e.status.toLowerCase()===b.toLowerCase());return(0,t.jsxs)("div",{className:"flex flex-col gap-6 p-6",children:[(0,t.jsx)("div",{className:"flex flex-col gap-2",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Security Alerts"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Manage and investigate security incidents and anomalies"})]}),(0,t.jsx)("div",{className:`text-sm font-medium ${l?"text-green-600":"text-red-600"}`,children:l?"ðŸŸ¢ Live":"ðŸ”´ Connecting..."})]})}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,t.jsxs)(x.Card,{className:"bg-gradient-to-r from-rose-50 to-rose-100",children:[(0,t.jsxs)(x.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(x.CardTitle,{className:"text-sm font-medium",children:"Critical Alerts"}),(0,t.jsx)(c.ShieldAlert,{className:"size-4 text-destructive"})]}),(0,t.jsxs)(x.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:N}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Requires immediate attention"})]})]}),(0,t.jsxs)(x.Card,{className:"bg-gradient-to-r from-yellow-50 to-yellow-100",children:[(0,t.jsxs)(x.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(x.CardTitle,{className:"text-sm font-medium",children:"Active Investigations"}),(0,t.jsx)(s.AlertTriangle,{className:"size-4 text-accent"})]}),(0,t.jsxs)(x.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:C}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Currently being analyzed"})]})]}),(0,t.jsxs)(x.Card,{className:"bg-gradient-to-r from-emerald-50 to-emerald-100",children:[(0,t.jsxs)(x.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(x.CardTitle,{className:"text-sm font-medium",children:"Resolved Today"}),(0,t.jsx)(i,{className:"size-4 text-green-500"})]}),(0,t.jsxs)(x.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:y}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Successfully mitigated"})]})]})]}),(0,t.jsxs)(x.Card,{children:[(0,t.jsx)(x.CardHeader,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(x.CardTitle,{children:"Alert History"}),(0,t.jsx)(x.CardDescription,{children:"Real-time security alerts and their current status"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(r.Search,{className:"absolute left-2.5 top-2.5 size-4 text-muted-foreground"}),(0,t.jsx)(u.Input,{type:"search",placeholder:"Search alerts...",className:"w-[200px] pl-8 lg:w-[300px]"})]}),(0,t.jsxs)(h.DropdownMenu,{children:[(0,t.jsx)(h.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(o.Button,{variant:"outline",size:"icon",children:(0,t.jsx)(n,{className:"size-4"})})}),(0,t.jsxs)(h.DropdownMenuContent,{align:"end",children:[(0,t.jsx)(h.DropdownMenuLabel,{children:"Filter by Severity"}),(0,t.jsx)(h.DropdownMenuSeparator,{}),(0,t.jsx)(h.DropdownMenuCheckboxItem,{checked:!0,children:"Critical"}),(0,t.jsx)(h.DropdownMenuCheckboxItem,{checked:!0,children:"High"}),(0,t.jsx)(h.DropdownMenuCheckboxItem,{checked:!0,children:"Medium"}),(0,t.jsx)(h.DropdownMenuCheckboxItem,{checked:!0,children:"Low"})]})]}),(0,t.jsxs)(m.Select,{value:b,onValueChange:v,children:[(0,t.jsx)(m.SelectTrigger,{className:"w-[130px]",children:(0,t.jsx)(m.SelectValue,{placeholder:"Status"})}),(0,t.jsxs)(m.SelectContent,{children:[(0,t.jsx)(m.SelectItem,{value:"all",children:"All Status"}),(0,t.jsx)(m.SelectItem,{value:"active",children:"Active"}),(0,t.jsx)(m.SelectItem,{value:"investigating",children:"Investigating"}),(0,t.jsx)(m.SelectItem,{value:"resolved",children:"Resolved"})]})]})]})]})}),(0,t.jsx)(x.CardContent,{children:p?(0,t.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,t.jsx)("div",{className:"text-muted-foreground",children:"Loading real-time data..."})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(j.Table,{children:[(0,t.jsx)(j.TableHeader,{children:(0,t.jsxs)(j.TableRow,{children:[(0,t.jsx)(j.TableHead,{children:"ID"}),(0,t.jsx)(j.TableHead,{children:"Severity"}),(0,t.jsx)(j.TableHead,{children:"Type"}),(0,t.jsx)(j.TableHead,{children:"Source"}),(0,t.jsx)(j.TableHead,{children:"Destination"}),(0,t.jsx)(j.TableHead,{children:"Status"}),(0,t.jsx)(j.TableHead,{children:"Timestamp"}),(0,t.jsx)(j.TableHead,{className:"text-right",children:"Actions"})]})}),(0,t.jsx)(j.TableBody,{children:w.length>0?w.map(e=>(0,t.jsxs)(j.TableRow,{children:[(0,t.jsx)(j.TableCell,{className:"font-medium",children:e.id}),(0,t.jsx)(j.TableCell,{children:(0,t.jsx)(d.Badge,{variant:"Critical"===e.severity?"destructive":"High"===e.severity?"default":"Medium"===e.severity?"secondary":"outline",className:"High"===e.severity?"bg-orange-500 hover:bg-orange-600":"",children:e.severity})}),(0,t.jsx)(j.TableCell,{children:e.type}),(0,t.jsx)(j.TableCell,{className:"font-mono text-xs",children:e.source}),(0,t.jsx)(j.TableCell,{className:"font-mono text-xs",children:e.destination}),(0,t.jsx)(j.TableCell,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["Active"===e.status&&(0,t.jsx)("div",{className:"size-2 rounded-full bg-destructive animate-pulse"}),"Investigating"===e.status&&(0,t.jsx)("div",{className:"size-2 rounded-full bg-accent"}),"Resolved"===e.status&&(0,t.jsx)("div",{className:"size-2 rounded-full bg-green-500"}),e.status]})}),(0,t.jsx)(j.TableCell,{className:"text-muted-foreground text-xs",children:new Date(e.timestamp).toLocaleString()}),(0,t.jsx)(j.TableCell,{className:"text-right",children:(0,t.jsx)(o.Button,{variant:"ghost",size:"sm",children:"Details"})})]},e.id)):(0,t.jsx)(j.TableRow,{children:(0,t.jsx)(j.TableCell,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No alerts found"})})})]}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(g.Pagination,{children:(0,t.jsxs)(g.PaginationContent,{children:[(0,t.jsx)(g.PaginationItem,{children:(0,t.jsx)(g.PaginationPrevious,{href:"#"})}),(0,t.jsx)(g.PaginationItem,{children:(0,t.jsx)(g.PaginationLink,{href:"#",isActive:!0,children:"1"})}),(0,t.jsx)(g.PaginationItem,{children:(0,t.jsx)(g.PaginationLink,{href:"#",children:"2"})}),(0,t.jsx)(g.PaginationItem,{children:(0,t.jsx)(g.PaginationLink,{href:"#",children:"3"})}),(0,t.jsx)(g.PaginationItem,{children:(0,t.jsx)(g.PaginationEllipsis,{})}),(0,t.jsx)(g.PaginationItem,{children:(0,t.jsx)(g.PaginationNext,{href:"#"})})]})})})]})})]})]})}e.s(["default",()=>p],16954)}]);