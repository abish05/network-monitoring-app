(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70065,e=>{"use strict";var t=e.i(28785),s=e.i(47163);function a({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...a})}function r({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...a})}function l({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",e),...a})}function i({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",e),...a})}function n({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",e),...a})}e.s(["Card",()=>a,"CardContent",()=>n,"CardDescription",()=>i,"CardHeader",()=>r,"CardTitle",()=>l])},50607,e=>{"use strict";var t=e.i(27055),s=e.i(64067);function a(e){let[a,r]=(0,s.useState)([]),[l,i]=(0,s.useState)([]),[n,d]=(0,s.useState)(null),[c,o]=(0,s.useState)(null),[x,m]=(0,s.useState)([]),[u,h]=(0,s.useState)(null),[p,f]=(0,s.useState)(!1),[j,N]=(0,s.useState)(!0),b=t.default.env.NEXT_PUBLIC_BACKEND_PORT||"5001",g=t.default.env.NEXT_PUBLIC_WS_URL||`ws://${window.location.hostname}:${b}`,v=e?.url||g;return(0,s.useEffect)(()=>{let e,t,s=()=>{try{(e=new WebSocket(v)).onopen=()=>{console.log("âœ… Connected to server"),f(!0),N(!1)},e.onmessage=e=>{let t=JSON.parse(e.data);switch(t.type){case"initial-data":r(t.data.alerts),i(t.data.logs),d(t.data.trafficData),t.data.networkData&&o(t.data.networkData),t.data.networkData&&m(e=>[...e.slice(-29),t.data.networkData]),t.data.health&&h(t.data.health);break;case"new-alert":r(e=>[t.data,...e].slice(0,20));break;case"alert-updated":r(e=>e.map(e=>e.id===t.data.id?t.data:e));break;case"new-log":i(e=>[t.data,...e].slice(0,50));break;case"traffic-update":d(t.data);break;case"network-update":o(t.data),m(e=>[...e.slice(-29),t.data]);break;case"health-update":h(t.data)}},e.onerror=e=>{console.error("âŒ WebSocket error:",e),f(!1)},e.onclose=()=>{console.log("ðŸ”Œ Disconnected from server"),f(!1),t=setTimeout(s,3e3)}}catch(e){console.error("Failed to connect:",e),f(!1),t=setTimeout(s,3e3)}};return s(),()=>{e&&e.close(),t&&clearTimeout(t)}},[v]),(0,s.useEffect)(()=>{let e=t.default.env.NEXT_PUBLIC_BACKEND_PORT||"5001",s=window.location.hostname,a=t.default.env.NEXT_PUBLIC_API_URL||`http://${s}:${e}`;fetch(`${a}/api/network`).then(e=>e.json()).then(e=>{e&&o(e)}).catch(()=>{}),fetch(`${a}/api/health`).then(e=>e.json()).then(e=>{e&&h(e)}).catch(()=>{})},[]),{alerts:a,logs:l,traffic:n,network:c,networkHistory:x,health:u,connected:p,loading:j,updateAlertStatus:(0,s.useCallback)(async(e,s)=>{try{let a=t.default.env.NEXT_PUBLIC_BACKEND_PORT||"5001",r=t.default.env.NEXT_PUBLIC_API_URL||`http://${window.location.hostname}:${a}`;return(await fetch(`${r}/api/alerts/${e}/status`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:s})})).json()}catch(e){throw console.error("Failed to update alert:",e),e}},[])}}e.s(["useRealTime",()=>a])},31713,e=>{"use strict";var t=e.i(28785),s=e.i(70065),a=e.i(69872),r=e.i(64877),l=e.i(42838);let i=(0,e.i(10965).default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);var n=e.i(50607);function d(){let{alerts:e,logs:d,traffic:c,network:o,connected:x,loading:m,health:u}=(0,n.useRealTime)(),h=c?.activeSessions||Math.round((o?.total?.rxBytesPerSec||0)/1e3),p=d?.filter(e=>/blocked|blocked connection|blocked/i.test(e.message)).length||0,f=e?.length||0,j=e?.filter(e=>"Critical"===e.severity).length||0,N=o?function(e){if(!e||isNaN(e))return"0 B/s";let t=8*e/1048576;return t>=1?`${t.toFixed(2)} Mbps`:`${(8*e/1024).toFixed(2)} Kbps`}((o.total.rxBytesPerSec+o.total.txBytesPerSec)/2):c?.totalBandwidth||"0 GB/s",b=e?.slice(0,4)||[],g=u?.services?Object.keys(u.services).map(e=>({service:e,status:u.services[e]})):[{service:"Firewall",status:{status:"Operational",uptime:"99.9%"}},{service:"IDS Engine",status:{status:"Operational",uptime:"99.8%"}},{service:"Traffic Monitor",status:{status:"Operational",uptime:"100%"}},{service:"Alert System",status:{status:"Operational",uptime:"99.7%"}}];return(0,t.jsxs)("div",{className:"flex flex-col gap-6 p-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Network Dashboard"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Real-time overview of your network security status"})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,t.jsxs)(s.Card,{className:"bg-gradient-to-r from-sky-50 to-sky-100",children:[(0,t.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium",children:"Active Connections"}),(0,t.jsx)(a.Activity,{className:"size-4 text-sky-600"})]}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-sky-700",children:h}),(0,t.jsx)("p",{className:"text-xs text-sky-500",children:"Live connected sessions"})]})]}),(0,t.jsxs)(s.Card,{className:"bg-gradient-to-r from-rose-50 to-rose-100",children:[(0,t.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium",children:"Threats Blocked"}),(0,t.jsx)(l.Shield,{className:"size-4 text-rose-600"})]}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-rose-700",children:p}),(0,t.jsx)("p",{className:"text-xs text-rose-500",children:"Blocked events (approx)"})]})]}),(0,t.jsxs)(s.Card,{className:"bg-gradient-to-r from-yellow-50 to-yellow-100",children:[(0,t.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium",children:"Active Alerts"}),(0,t.jsx)(r.AlertTriangle,{className:"size-4 text-yellow-600"})]}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-yellow-700",children:f}),(0,t.jsxs)("p",{className:"text-xs text-yellow-500",children:[j," critical"]})]})]}),(0,t.jsxs)(s.Card,{className:"bg-gradient-to-r from-emerald-50 to-emerald-100",children:[(0,t.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium",children:"Network Throughput"}),(0,t.jsx)(i,{className:"size-4 text-emerald-600"})]}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-emerald-700",children:N}),(0,t.jsx)("p",{className:"text-xs text-emerald-500",children:"Aggregate RX/TX"})]})]})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)(s.Card,{className:"bg-white/80",children:[(0,t.jsxs)(s.CardHeader,{children:[(0,t.jsx)(s.CardTitle,{children:"Recent Threats"}),(0,t.jsx)(s.CardDescription,{children:"Latest security alerts detected"})]}),(0,t.jsx)(s.CardContent,{children:(0,t.jsx)("div",{className:"space-y-4",children:b.length>0?b.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between border-b pb-3 last:border-0 last:pb-0",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e.type}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Source: ",e.source]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("span",{className:`inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${"Critical"===e.severity?"bg-destructive/10 text-destructive":"bg-accent/10 text-accent"}`,children:e.severity}),(0,t.jsx)("p",{className:"mt-1 text-xs text-muted-foreground",children:new Date(e.timestamp).toLocaleTimeString()})]})]},e.id||s)):(0,t.jsx)("div",{className:"text-muted-foreground",children:"No recent threats"})})})]}),(0,t.jsxs)(s.Card,{className:"bg-white/80",children:[(0,t.jsxs)(s.CardHeader,{children:[(0,t.jsx)(s.CardTitle,{children:"System Status"}),(0,t.jsx)(s.CardDescription,{children:"Current operational status"})]}),(0,t.jsx)(s.CardContent,{children:(0,t.jsx)("div",{className:"space-y-4",children:g.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between border-b pb-3 last:border-0 last:pb-0",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e.service}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Uptime: ",e.status.uptime]})]}),(0,t.jsx)("span",{className:`inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${"Operational"===e.status.status?"bg-emerald-100 text-emerald-700":"bg-amber-100 text-amber-700"}`,children:e.status.status})]},e.service))})})]})]})]})}e.s(["default",()=>d],31713)}]);